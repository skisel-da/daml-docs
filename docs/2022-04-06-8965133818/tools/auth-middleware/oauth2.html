<!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OAuth 2.0 Auth Middleware &mdash; Daml SDK 0.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
  <script src="../../_static/jquery.js"></script>
  <script src="../../_static/underscore.js"></script>
  <script src="../../_static/doctools.js"></script>
  <script src="../../_static/clipboard.min.js"></script>
  <script src="../../_static/copybutton.js"></script>
  
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="Overview of Daml ledgers" href="../../deploying.html" />
  <link rel="prev" title="Auth Middleware" href="index.html" /> 

  
  <link rel="icon" type="image/svg+xml"  href="../../_static/images/daml-logo-mark-light.svg">
  <link rel="alternate icon" href="../../_static/images/daml-favicon-1.ico">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MSWJMNX');</script>
  <!-- End Google Tag Manager -->

  
  <!-- Mopinion Pastea.se  start --><script type="text/javascript">(function(){var id="4s6vwov7ad6qyxhq8iwbyhocrsn2nm36k25";var js=document.createElement("script");js.setAttribute("type","text/javascript");js.setAttribute("src","//deploy.mopinion.com/js/pastease.js");js.async=true;document.getElementsByTagName("head")[0].appendChild(js);var t=setInterval(function(){try{new Pastease.load(id);clearInterval(t)}catch(e){}},50)})();</script><!-- Mopinion Pastea.se end -->
</head>

<body class="wy-body-for-nav">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MSWJMNX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-nav-side-shadow"></div>
      <div class="wy-side-scroll">

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
          
          
          
          
          
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Daml Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installing the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/path-variables.html">Setting JAVA_HOME and PATH Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/manual-download.html">Manually Installing the SDK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Building Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/app-architecture.html">App Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/first-feature.html">Your First Feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/testing.html">Testing Your Web App</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.daml.com/cheat-sheet">Cheat Sheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../writing-daml.html">Writing Daml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/0_Intro.html">An introduction to Daml</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/1_Token.html">1 Basic contracts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/2_DamlScript.html">2 Testing templates using Daml Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/3_Data.html">3 Data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/4_Transformations.html">4 Transforming data using choices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/5_Restrictions.html">5 Adding constraints to a contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/6_Parties.html">6 Parties and authority</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/7_Composing.html">7 Composing choices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/8_Exceptions.html">8 Exception Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/9_Dependencies.html">9 Working with Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/10_Functional101.html">10 Functional Programming 101</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/11_StdLib.html">11 Intro to the Daml Standard Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/intro/12_Testing.html">12 Testing Daml Contracts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/index.html">Language reference docs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/structure.html">Overview: template structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/templates.html">Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/choices.html">Choices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/updates.html">Updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/data-types.html">Data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/working-with.html">Built-in functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/expressions.html">Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/functions.html">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/file-structure.html">File structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/packages.html">Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/contract-keys.html">Contract keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/exceptions.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/reference/interfaces.html">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/stdlib/index.html">The standard library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/Prelude.html">Prelude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Action.html">DA.Action</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Action-State.html">DA.Action.State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Action-State-Class.html">DA.Action.State.Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Assert.html">DA.Assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Bifunctor.html">DA.Bifunctor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-BigNumeric.html">DA.BigNumeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Date.html">DA.Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Either.html">DA.Either</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Exception.html">DA.Exception</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Foldable.html">DA.Foldable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Functor.html">DA.Functor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-List.html">DA.List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-List-BuiltinOrder.html">DA.List.BuiltinOrder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-List-Total.html">DA.List.Total</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Logic.html">DA.Logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Map.html">DA.Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Math.html">DA.Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Monoid.html">DA.Monoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-NonEmpty.html">DA.NonEmpty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-NonEmpty-Types.html">DA.NonEmpty.Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Numeric.html">DA.Numeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Optional.html">DA.Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Record.html">DA.Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Semigroup.html">DA.Semigroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Set.html">DA.Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Stack.html">DA.Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Text.html">DA.Text</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-TextMap.html">DA.TextMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Time.html">DA.Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Traversable.html">DA.Traversable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Tuple.html">DA.Tuple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/stdlib/DA-Validation.html">DA.Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns.html">Good design patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/initaccept.html">Initiate and Accept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/multiparty-agreement.html">Multiple party agreement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/delegation.html">Delegation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/authorization.html">Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/locking.html">Locking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../daml/patterns/locking/locking-by-archiving.html">Locking by archiving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../daml/patterns/locking/locking-by-state.html">Locking by state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../daml/patterns/locking/locking-by-safekeeping.html">Locking by safekeeping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/legends.html">Diagram legends</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Building applications</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../building-applications.html">Building Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/app-arch.html">Application architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/index.html">JavaScript Client Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-ts/daml2js.html">JavaScript Code Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-ts/daml-react.html">&#64;daml/react</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-ts/daml-ledger.html">&#64;daml/ledger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-ts/daml-types.html">&#64;daml/types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/index.html">HTTP JSON API Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../json-api/lf-value-specification.html">Daml-LF JSON Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../json-api/search-query-language.html">Query language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../json-api/production-setup.html">Production Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml-script/index.html">Daml Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml-script/api/index.html">Daml Script Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../daml-script/api/Daml-Script.html">Daml.Script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml-repl/index.html">Daml REPL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/index.html">Upgrading and Extending Daml applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade/extend.html">Extending Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade/upgrade.html">Upgrading Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade/automation.html">Automating the Upgrade Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/ledger-api.html">The Ledger API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/services.html">The Ledger API services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/index.html">gRPC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/error-codes.html">Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/proto-docs.html">Ledger API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/daml-to-ledger-api.html">How Daml types are translated to protobuf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/daml-lf-translation.html">How Daml types are translated to Daml-LF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/index.html">Java bindings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../app-dev/bindings-java/codegen.html">Generate Java code from Daml</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../app-dev/bindings-java/example.html">Ping Pong Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../app-dev/bindings-java/quickstart.html">Iou Quickstart Tutorial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-x-lang/index.html">Creating your own bindings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/command-deduplication.html">Command deduplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../triggers/index.html">Daml Triggers - Off-Ledger Automation in Daml</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../triggers/api/index.html">Daml Trigger Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../triggers/api/Daml-Trigger.html">Daml.Trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../triggers/api/Daml-Trigger-Assert.html">Daml.Trigger.Assert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../triggers/api/Daml-Trigger-LowLevel.html">Daml.Trigger.LowLevel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../trigger-service/index.html">Trigger Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../trigger-service/authorization.html">Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trigger-service/auth0_example.html">Auth0 Example Configuration</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Auth Middleware</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">OAuth 2.0 Auth Middleware</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deploying to Daml ledgers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deploying.html">Overview of Daml ledgers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../deploy/generic_ledger.html">Deploying to a generic Daml ledger</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operating Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../operating-daml.html">Operating Daml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ops/pruning.html">Participant Pruning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/metering.html">Participant Metering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/requirements.html">System Requirements</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Developer Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../assistant.html">Daml Assistant (<code class="docutils literal notranslate"><span class="pre">daml</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/daml-studio.html">Daml Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sandbox.html">Daml Sandbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../navigator/index.html">Navigator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codegen.html">Daml codegen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../profiler.html">Daml Profiler</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/glossary.html">Glossary of concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/ledger-model/index.html">Daml Ledger Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-structure.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-integrity.html">Integrity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-privacy.html">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-daml.html">Daml: Defining Contract Models Compactly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/identity-and-package-management.html">Identity and Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/time.html">Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/local-ledger.html">Causality and Local Ledgers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://daml.com/examples">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Early Access Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../export/index.html">Ledger Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visual.html">Visualizing Daml Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/interoperability.html">Ledger Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-repudiation.html">Non-repudiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/connect/index.html">Operating Daml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/helm.html">Daml Helm Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/auth0.html">Setting Up Auth0</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Daml Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/overview.html">Daml Ecosystem Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../support/status-definitions.html">Status Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../support/component-statuses.html">Feature and Component Statuses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support/releases.html">Releases and Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/compatibility.html">Portability, Compatibility, and Support Durations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/support.html">Getting Help</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../canton-refs.html">Dummy Canton Refs</a></li>
</ul>

          
          
          
          <div class="pdf-download"><a href="../../_downloads/DigitalAssetSDK.pdf" download>Download as PDF</a></div>
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <div class="topbar fixed">
        
        <nav class="wy-nav-top" aria-label="top navigation">
          
          <i data-toggle="wy-nav-top" class="wy-nav-top-toggle"></i>
          
        </nav>
        <!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="navbar">
    <h1><img src="../../_static/images/Daml_Logo_Blue.svg"></h1>
    <div class="navbar-menu">
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com/developers" role="menuitem" class="da-menu-link">Developers</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com/products" role="menuitem" class="da-menu-link">Products</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com" role="menuitem" class="da-menu-link">Company</a>
        </div>
    </div>
</div>

        <div class="version ">
          <span class="hide-mobile">Version&nbsp;</span><span class="version_switcher_placeholder"></span>
          
        </div>


        <!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->
<div class="search-inline">
    <div id="rtd-search-inline-form" class="wy-form">
        <input type="text" class="search-inline-input" placeholder="Search" name="q">
        <img src="../../_static/images/Search.svg" class="search-inline-img"/>
    </div>
    <div class="search-alert">
        Please enter at least 3 letters.
    </div>
    <div id="search-inline-results" class="search-inline-results">
        
    </div>
</div>
          <!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="content-menu collapsed">
    <span class="content-menu-title">In This Section</span>
    <span class="content-menu-expand"></span>
    <div class="content-menu-wrapper">
        
        <!-- Local TOC -->
        <div class="content-menu-toc"><ul>
<li><a class="reference internal" href="#">OAuth 2.0 Auth Middleware</a><ul>
<li><a class="reference internal" href="#oauth-2-0-configuration">OAuth 2.0 Configuration</a><ul>
<li><a class="reference internal" href="#request-templates">Request Templates</a><ul>
<li><a class="reference internal" href="#authorization-request">Authorization Request</a><ul>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#returns">Returns</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#token-request">Token Request</a><ul>
<li><a class="reference internal" href="#id3">Arguments</a></li>
<li><a class="reference internal" href="#id4">Returns</a></li>
<li><a class="reference internal" href="#id5">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#refresh-request">Refresh Request</a><ul>
<li><a class="reference internal" href="#id7">Arguments</a></li>
<li><a class="reference internal" href="#id8">Returns</a></li>
<li><a class="reference internal" href="#id9">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#deployment-notes">Deployment Notes</a></li>
</ul>
</li>
</ul>
</div>
        
    </div>
</div>
        

      </div>
      <div class="wy-nav-content">
        
        <div class="rst-content">
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
                
  <div class="section" id="oauth-2-0-auth-middleware">
<span id="oauth2-middleware"></span><h1>OAuth 2.0 Auth Middleware<a class="headerlink" href="#oauth-2-0-auth-middleware" title="Permalink to this headline">¶</a></h1>
<p>Daml includes an implementation of an auth middleware that supports <a class="reference external" href="https://oauth.net/2/grant-types/authorization-code/">OAuth 2.0 Authorization Code Grant</a>.
The implementation aims to be configurable to support different OAuth 2.0 providers and to allow custom mappings from Daml ledger claims to OAuth 2.0 scopes.</p>
<div class="section" id="oauth-2-0-configuration">
<h2>OAuth 2.0 Configuration<a class="headerlink" href="#oauth-2-0-configuration" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-3">RFC 6749</a> specifies that OAuth 2.0 providers offer two endpoints:
The <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-3.1">authorization endpoint</a>
and the <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-3.2">token endpoint</a>.
The URIs for these endpoints can be configured independently using the following fields:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">oauth-auth</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">oauth-token</span></code></li>
</ul>
<p>The OAuth 2.0 provider may require that the application identify itself using a client identifier and client secret.
These can be specified using the following environment variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">DAML_CLIENT_ID</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">DAML_CLIENT_SECRET</span></code></li>
</ul>
<p>The auth middleware assumes that the OAuth 2.0 provider issues JWT access tokens.
The <code class="docutils literal notranslate"><span class="pre">/auth</span></code> endpoint will validate the token, if available, and ensure that it grants the requested claims.
The auth middleware accepts the same command-line flags as the <a class="reference internal" href="../sandbox.html#sandbox-authorization"><span class="std std-ref">Daml Sandbox</span></a> to define the public key for token validation.</p>
<div class="section" id="request-templates">
<h3>Request Templates<a class="headerlink" href="#request-templates" title="Permalink to this headline">¶</a></h3>
<p>The exact format of OAuth 2.0 requests may vary between providers.
Furthermore, the mapping from Daml ledger claims to OAuth 2.0 scopes is defined by the IAM operator.
For that reason OAuth 2.0 requests made by auth middleware can be configured using user defined <a class="reference external" href="https://jsonnet.org/">Jsonnet</a> templates.
Templates are parameterized configurations expressed as top-level functions.</p>
<div class="section" id="authorization-request">
<h4>Authorization Request<a class="headerlink" href="#authorization-request" title="Permalink to this headline">¶</a></h4>
<p>This template defines the format of the <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-4.1.1">Authorization request</a>.
Use the following config field to use a custom template:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">oauth-auth-template</span></code></li>
</ul>
<div class="section" id="arguments">
<h5>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h5>
<p>The template will be passed the following arguments:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">config</span></code> (object)</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">clientId</span></code> (string) the OAuth 2.0 client identifier</li>
<li><code class="docutils literal notranslate"><span class="pre">clientSecret</span></code> (string) the OAuth 2.0 client secret</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">request</span></code> (object)</dt><dd><ul>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">claims</span></code> (object) the requested claims</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">admin</span></code> (bool)</li>
<li><code class="docutils literal notranslate"><span class="pre">applicationId</span></code> (string or null)</li>
<li><code class="docutils literal notranslate"><span class="pre">actAs</span></code> (list of string)</li>
<li><code class="docutils literal notranslate"><span class="pre">readAs</span></code> (list of string)</li>
</ul>
</dd>
</dl>
</li>
<li><code class="docutils literal notranslate"><span class="pre">redirectUri</span></code> (string)</li>
<li><code class="docutils literal notranslate"><span class="pre">state</span></code> (string)</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="returns">
<h5>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h5>
<p>The query parameters for the authorization endpoint encoded as an object with string values.</p>
</div>
<div class="section" id="example">
<h5>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>local scope(claims) =
  local admin = if claims.admin then &quot;admin&quot;;
  local applicationId = if claims.applicationId != null then &quot;applicationId:&quot; + claims.applicationId;
  local actAs = std.map(function(p) &quot;actAs:&quot; + p, claims.actAs);
  local readAs = std.map(function(p) &quot;readAs:&quot; + p, claims.readAs);
  [admin, applicationId] + actAs + readAs;

function(config, request) {
  &quot;audience&quot;: &quot;https://daml.com/ledger-api&quot;,
  &quot;client_id&quot;: config.clientId,
  &quot;redirect_uri&quot;: request.redirectUri,
  &quot;response_type&quot;: &quot;code&quot;,
  &quot;scope&quot;: std.join(&quot; &quot;, [&quot;offline_access&quot;] + scope(request.claims)),
  &quot;state&quot;: request.state,
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="token-request">
<h4>Token Request<a class="headerlink" href="#token-request" title="Permalink to this headline">¶</a></h4>
<p>This template defines the format of the <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-4.1.3">Token request</a>.
Use the following config field to use a custom template:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">oauth-token-template</span></code></li>
</ul>
<div class="section" id="id3">
<h5>Arguments<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>The template will be passed the following arguments:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">config</span></code> (object)</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">clientId</span></code> (string) the OAuth 2.0 client identifier</li>
<li><code class="docutils literal notranslate"><span class="pre">clientSecret</span></code> (string) the OAuth 2.0 client secret</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">request</span></code> (object)</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">code</span></code> (string)</li>
<li><code class="docutils literal notranslate"><span class="pre">redirectUri</span></code> (string)</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="id4">
<h5>Returns<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<p>The request parameters for the token endpoint encoded as an object with string values.</p>
</div>
<div class="section" id="id5">
<h5>Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function(config, request) {
  &quot;client_id&quot;: config.clientId,
  &quot;client_secret&quot;: config.clientSecret,
  &quot;code&quot;: request.code,
  &quot;grant_type&quot;: &quot;authorization_code&quot;,
  &quot;redirect_uri&quot;: request.redirectUri,
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="refresh-request">
<h4>Refresh Request<a class="headerlink" href="#refresh-request" title="Permalink to this headline">¶</a></h4>
<p>This template defines the format of the <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-6">Refresh request</a>.
Use the following config field to use a custom template:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">oauth-refresh-template</span></code></li>
</ul>
<div class="section" id="id7">
<h5>Arguments<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<p>The template will be passed the following arguments:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">config</span></code> (object)</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">clientId</span></code> (string) the OAuth 2.0 client identifier</li>
<li><code class="docutils literal notranslate"><span class="pre">clientSecret</span></code> (string) the OAuth 2.0 client secret</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">request</span></code> (object)</dt><dd><ul>
<li><code class="docutils literal notranslate"><span class="pre">refreshToken</span></code> (string)</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="id8">
<h5>Returns<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<p>The request parameters for the authorization endpoint encoded as an object with string values.</p>
</div>
<div class="section" id="id9">
<h5>Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>function(config, request) {
  &quot;client_id&quot;: config.clientId,
  &quot;client_secret&quot;: config.clientSecret,
  &quot;grant_type&quot;: &quot;refresh_code&quot;,
  &quot;refresh_token&quot;: request.refreshToken,
}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="deployment-notes">
<span id="oauth2-middleware-deployment"></span><h2>Deployment Notes<a class="headerlink" href="#deployment-notes" title="Permalink to this headline">¶</a></h2>
<p>The auth middleware API relies on sharing cookies between the auth middleware and the Daml application.
One way to enable this is to expose the auth middleware and the Daml application under the same domain, e.g. through a reverse proxy.
Note that you will need to specify the external callback URI in that case using the <code class="docutils literal notranslate"><span class="pre">--callback</span></code> command-line flag.</p>
<p>For example, assuming the following nginx configuration snippet:</p>
<div class="highlight-nginx notranslate"><div class="highlight"><pre><span></span><span class="k">http</span> <span class="p">{</span>
  <span class="kn">server</span> <span class="p">{</span>
    <span class="kn">server_name</span> <span class="s">example.com</span>
    <span class="s">location</span> <span class="s">/auth/</span> <span class="p">{</span>
      <span class="kn">proxy_pass</span> <span class="s">http://localhost:3000/</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You would invoke the OAuth 2.0 auth middleware with the following flags:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>oauth2-middleware <span class="se">\</span>
    --config oauth-middleware.conf
</pre></div>
</div>
<p>The required config would look like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
  // Environment variables:
  // DAML_CLIENT_ID      The OAuth2 client-id - must not be empty
  // DAML_CLIENT_SECRET  The OAuth2 client-secret - must not be empty
  client-id = ${DAML_CLIENT_ID}
  client-secret = ${DAML_CLIENT_SECRET}

  //IP address that OAuth2 Middleware service listens on. Defaults to 127.0.0.1.
  address = &quot;127.0.0.1&quot;
  //OAuth2 Middleware service port number. Defaults to 3000. A port number of 0 will let the system pick an ephemeral port. Consider specifying `--port-file` option with port number 0.
  port = 3000

  //URI to the auth middleware&#39;s callback endpoint `/cb`. By default constructed from the incoming login request.
  callback-uri = &quot;https://example.com/auth/cb&quot;

  //Maximum number of simultaneously pending login requests. Requests will be denied when exceeded until earlier requests have been completed or timed out.
  max-login-requests = 250

  //Login request timeout. Requests will be evicted if the callback endpoint receives no corresponding request in time.
  login-timeout = 60s

  //Enable the Secure attribute on the cookie that stores the token. Defaults to true. Only disable this for testing and development purposes.
  cookie-secure = &quot;true&quot;

  //URI of the OAuth2 authorization endpoint
  oauth-auth=&quot;https://oauth2-provider.com/auth_uri&quot;

  //URI of the OAuth2 token endpoint
  oauth-token=&quot;https://oauth2-provider.com/token_uri&quot;

  //OAuth2 authorization request Jsonnet template
  oauth-auth-template=&quot;file://path/oauth/auth/template&quot;

  //OAuth2 token request Jsonnet template
  oauth-token-template = &quot;file://path/oauth/token/template&quot;

  //OAuth2 refresh request Jsonnet template
  oauth-refresh-template = &quot;file://path/oauth/refresh/template&quot;

  // Enables JWT-based authorization, where the JWT is signed by one of the below Jwt based token verifiers
  token-verifier {
    // type can be rs256-crt, es256-crt, es512-crt or rs256-jwks
    type = &quot;rs256-jwks&quot;
    // X509 certificate file (.crt)/JWKS url from where the public key is loaded
    uri = &quot;https://example.com/.well-known/jwks.json&quot;
  }
}
</pre></div>
</div>
<p>The oauth2-middleware can also be started using cli-args.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Configuration file is the recommended way to run oauth2-middleware, running via cli-args is now deprecated</p>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>oauth2-middleware <span class="se">\</span>
    --callback https://example.com/auth/cb <span class="se">\</span>
    --address localhost <span class="se">\</span>
    --http-port <span class="m">3000</span> <span class="se">\</span>
    --oauth-auth https://oauth2-provider.com/auth_uri <span class="se">\</span>
    --oauth-token https://oauth2-provider.com/token_uri <span class="se">\</span>
    --auth-jwt-rs256-jwks https://example.com/.well-known/jwks.json
</pre></div>
</div>
<p>Some browsers reject <code class="docutils literal notranslate"><span class="pre">Secure</span></code> cookies on unencrypted connections even on localhost.
You can pass the command-line flag <code class="docutils literal notranslate"><span class="pre">--cookie-secure</span> <span class="pre">no</span></code> for testing and development on localhost to avoid this.</p>
</div>
</div>


              
            </div>
            
            
              <!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="index.html" class="da-btn da-btn-label btn-prev" title="Auth Middleware" accesskey="p" rel="prev">Previous</a>
      
      
        <a href="../../deploying.html" class="da-btn da-btn-label btn-next" title="Overview of Daml ledgers" accesskey="n" rel="next">Next</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. Any unauthorized use, duplication or distribution is strictly prohibited. &#34;Digital Asset&#34; and &#34;Daml&#34; are Registered in the U.S. Patent and Trademark Office.

    </p>
  </div> 

</footer>
            
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->





  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>


  
    
  
  <div id="inpageContent"></div>
  

</body>
</html>